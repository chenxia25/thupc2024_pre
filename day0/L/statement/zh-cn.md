{{ self.title() }}

{{ s('background') }}

安宁顷刻今将逝，末日黑云伺隙来。宿命无情何所惧？越其止境冀花开。

{{ s('description') }}

为了执行彻底毁灭世界的疯狂计划，一位占用了已死之人的躯壳的神秘男子在这颗蓝色的星球上创造出了无数座末日塔。这些末日塔会散发出浓密的以太射线，对进入末日塔附近的几乎所有生物进行精神控制，只有受到特殊加护的人才能在接近末日塔时免受以太射线的控制。

一些受到加护的义勇队对这些末日塔进行了调查。调查结果显示，这些末日塔组成了复杂的以太收集系统，持续不断地从大地中吸收以太，并将收集到的以太传输到位于帝国的中枢塔。为了彻底调查末日塔，并尝试对其进行破坏，一队持有特殊加护的英雄决定勇闯其中一座末日塔。如果英雄们能够破坏掉他们进入的末日塔，原有的以太传输网络就会遭到破坏，因此大家决定对所有可以闯入的塔中，破坏后能使得网络的最大传输容量降到最低的塔进行深入调查。

假设星球的表面是一个中心位于 $(0, 0, 0)$，半径为 $R$ 的完美的球面。在当前已经调查的局部地域中，可以认为一共有 $N$ 座末日塔通过 $M$ 条传输通道进行传输。假设 $N$ 座末日塔的高度相较于星球大小可以忽略不计，即将第 $i$ 座塔视作球面上的一个点 $\left(x_i, y_i, z_i\right)$。在这 $N$ 座末日塔中，第 $s$ 号塔是最主要的以太吸收塔，第 $t$ 号塔是位于帝国的中枢塔；这两座塔的以太浓度都显著地高于其它的末日塔，不能保证持有特殊加护的人进入塔中也一定能平安无事地返回，因此只能选择除了这两座塔之外的末日塔闯入。这一局部的以太传输网络的目的即为将第 $s$ 号塔吸收的以太沿着传输通道传输到第 $t$ 号塔，并且使得单位时间内传输的以太流量最大。

传输通道的作用是将两座末日塔直接相连，让两座塔之间能够互相传输以太。第 $i$ 条传输通道连接第 $u_i$ 座塔和第 $v_i$ 座塔。传输通道是双向的，但是同一时间只能单向地从第 $u_i$ 座塔向第 $v_i$ 座塔传输以太，或者从第 $v_i$ 座塔向第 $u_i$ 座塔传输以太。为了节省不必要的成本，传输通道的两端不会连接相同的塔，也不会有两条传输通道连接相同的末日塔对。为了降低传输距离，每条传输通道都是沿着其直接相连的两座末日塔所在的大圆的**劣弧**铺设的，故传输通道的长度 $r_i$ 即为两座末日塔在星球表面的**球面距离**。另外，或许是因为那位神秘男子不希望传输通道之间互相干扰，这些传输通道代表的劣弧之间互不相交。

有两个因素影响由传输通道**直接相连**的两座塔之间以太传输的效率：一是每座塔本身的传输能力，其中第 $i$ 座塔的传输能力为 $q_i$；二是两座塔之间的距离，也即传输通道的长度。根据初步调查的结果，推测单位时间内第 $i$ 条传输通道可以传输的以太容量为

$$
\frac{Kq_{u_i} q_{v_i}}{R_i^2}
$$

其中 $K$ 是通过分析观测数据得出的常数。传输网络是自适应的。传输网络会自动地确定一个以太的传输方案，使得在满足所有传输通道的容量限制的前提下，单位时间内通过该传输网络传输到第 $t$ 座塔的以太流量最大。并且，当末日塔或传输通道被破坏时，传输网络也会自动调节至一个在新的网络中能传输最大流量的新方案。其中，一条传输通道被破坏相当于这条通道的容量降至 $0$；末日塔被破坏相当于与该末日塔相连的所有通道都被破坏，对应的容量都降至 $0$。

虽然没有任何人能保证闯入末日塔之后就一定能将其破坏，但作为勇闯末日塔小队的先锋，你还是想在出发之前计算一下，如果成功破坏了将要闯入的末日塔，传输网络单位时间的最大传输流量将会降至多少。

这次大胆的行动计划最终能否拯救这个世界，眼下恐怕谁都无法事先料定。但为了这颗星球的未来，我们只能放手一搏。

{{ s('input format') }}

{{ self.input_file() }}

输入的第一行包括四个正整数 $N, M, s, t$（$3\le N\le 1000$，$2\le M\le \frac{N(N-1)}{2}$，$1\le s, t\le N$），分别表示该传输网络包含的末日塔数量，传输通道数量，最主要的以太吸收塔的编号和中枢塔的编号。保证传输网络是连通的。

输入的第二行包括两个实数 $R, K$（$1\le R\le 10^3$，$1\le K\le 10^6$），分别表示星球的半径和计算以太容量时用到的常数。

接下来 $N$ 行，每行三个实数 $a_i, b_i, q_i$（$0\le a_i\le 1$，$0\le b_i< 2$，$1\le q_i \le 10^3$），描述第 $i$ 座末日塔的信息，其中 $q_i$ 表示第 $i$ 座末日塔的传输能力， $a_i$ 和 $b_i$ 共同描述末日塔的位置：令 $\theta_i = \pi a_i$，$\varphi_i = \pi b_i$（如果你习惯使用角度值而不是弧度制，可以将 $\pi$ 改为 $180^\circ$），则 $\left(x_i, y_i, z_i\right) = \left(R \sin\theta_i \cos\varphi_i, R\sin\theta_i \sin\varphi_i, R\cos\theta_i\right)$。保证末日塔的位置各不相同。

最后 $M$ 行，每行两个正整数 $u_i, v_i$（$1\le u_i, v_i\le N$），表示一条传输网络连接的两座末日塔的编号。

保证输入的所有实数保留到小数点后第 $4$ 位。

{{ s('output format') }}

{{ self.output_file() }}

输出一个实数，表示如果成功破坏了将要闯入的末日塔，新的传输网络单位时间的最大传输流量。当你的输出与标准输出的相对误差或绝对误差不超过 $10^{-6}$ 时，我们认为你的输出是正确的。

{{ s('sample', 1) }}

{{ self.sample_text() }}

{{ self.title_sample_description() }}

原来的传输网络单位时间最大传输流量为 $188/\pi^2$。破坏第 $2$ 个末日塔或第 $5$ 个末日塔都能使新的传输网络单位时间的最大传输流量降至 $80/\pi^2$，而破坏第 $3$ 个末日塔或第 $4$ 个末日塔只能使新的传输网络单位时间的最大传输流量降至 $94/\pi^2$，所以应该选择第 $2$ 个或第 $5$ 个末日塔尝试破坏。

{{ s('subtasks') }}

对于所有数据，保证 $3\le N\le 1000$，$2\le M\le \frac{N(N-1)}{2}$，$1\le s, t, u_i, v_i\le N$，$1\le R\le 10^3$，$1\le K\le 10^6$，$0\le a_i\le 1$，$0\le b_i<2$，$1\le q_i\le 10^3$，同时保证末日塔的位置各不相同。

{{ s('hint') }}

在三维空间中，我们可以用一个有序的实数三元组 $(x, y, z)$ 来描述一个点的位置，其中 $x, y, z$ 分别称作这个点的横坐标、纵坐标和竖坐标。

三维空间中一个球心在 $\left(x_0, y_0, z_0\right)$、半径为 $R$ 的球面是指空间中所有满足 $\left(x-x_0\right)^2 + \left(y-y_0\right)^2+\left(z-z_0\right)^2=R^2$ 的点 $(x,y,z)$ 构成的点集。对于该球面上给定的两个不同点 $\left(x_1, y_1, z_1\right), \left(x_2, y_2, z_2\right)$，

- 如果它们不是一对对跖点（两个点是对跖点当且仅当它们在空间上的欧氏距离为 $2R$；也称对径点），则它们和球心不在同一直线上，这三个点唯一确定了一个平面。这个平面与球面的交线被称作“大圆”（great circle）。大圆的弧被这两个点分成了两个部分，其中较短部分的长度称为这两点在该球面上的距离。

- 如果两个点是对跖点，则定义它们在球面上的距离为 $\pi R$。