{{ self.title() }}

{{ s('background') }}

_“我已经买不起第二个机器人了。”_

_“那就雇点人来凑数吧。注意别给死里头。”_

{{ s('description') }}

你是一个矿坑老板。

你的矿坑是一个二叉树形结构，有 $n$ 个节点。$1$ 号点为地面，对于所有的 $2\le i\le n$，$i$ 号节点与更浅层的 $f_i$ 号节点通过通道相连，其中 $f_i<i$，且相同的 $f_i$ 最多出现两次。矿坑的不同节点的产量和开采难度均不相同。对于 $i$ 号节点 $(2\le i\le n)$，如果派一个机器人开采，单位时间内能有 $r_i$ 的产出，如果派一个人类开采，单位时间内能有 $p_i$ 的产出。地面没有产出。所有通道与节点都十分狭窄，每个节点都只能容下一名工人（工人包括人类和机器人），每个通道也只能恰好容一名工人通过。

你有一个机器人，初始位于 $s$ 号节点。你的矿坑里还没有人类工人。

你现在有 $q$ 条计划需要按顺序执行。计划分为以下四种：

1. 将机器人向更浅的方向移动。
2. 将机器人向更深的方向移动。
3. 给定节点 $v$，将一名人类从 $1$ 号节点送入矿坑，并移动至节点 $v$。
4. 给定节点 $v$，将一名人类从节点 $v$ 移动至 $1$ 号节点，再移出矿坑。

在移动的任何时刻，只能有最多一名工人在通道中，其余工人都必须在节点上。无论是在执行一条计划之前、之时还是之后，人类都可以在满足上述移动规则的前提下随意移动，但不能进入或离开矿坑（矿坑内的工人到达 $1$ 号节点不算离开矿坑），因为你在看着他们。机器人只有在执行前两种计划之时才可以移动。

对于前两种计划，机器人需要至少移动通过一条通道。机器人不必连续移动，也就是说，在机器人的两次移动之间，可以让人类移动。“执行之时”指从第一次移动机器人开始到最后一次移动机器人结束。

对于后两种计划，计划开始时这名人类就已经被指定，比如执行第三种计划时你不能将一名人类送入矿坑后再让另一名人类移动至节点 $v$ 并结束执行。“执行之时”指将人类送入矿坑（选定节点 $v$ 的人类）开始到其移动至节点 $v$（其移出矿坑）结束。

在每条计划执行之后（且人类移动后），你会让所有的工人采一单位时间的矿。问执行完所有计划之后（包括最后一条计划之后的采矿），你的产出之和最多可以达到多少。

{{ s('input format') }}

{{ self.input_file() }}

第一行两个整数 $n,q$。

第二行 $n-1$ 个整数，其中第 $i$ 个表示 $f_{i+1}$。

第三行 $n-1$ 个整数，其中第 $i$ 个表示 $r_{i+1}$。

第四行 $n-1$ 个整数，其中第 $i$ 个表示 $p_{i+1}$。

接下来 $q$ 行，每行表示一条计划。计划的格式如下：

- `1` 表示第一种计划：将机器人向更浅的方向移动；
- `2` 表示第二种计划：将机器人向更深的方向移动；
- `3 v` 表示第三种计划：给定节点 $v$，将一名人类从 $1$ 号节点送入矿坑，并移动至节点 $v$；
- `4 v` 表示第四种计划：给定节点 $v$，将一名人类从节点 $v$ 移动至 $1$ 号节点，再移出矿坑。

{{ s('output format') }}

{{ self.output_file() }}

如果无论如何你都无法完成你的计划，输出一行 `No solution.`。否则输出一行一个整数，表示你的产出之和的最大值。

{{ s('sample', 1) }}

{{ self.sample_text() }}

{{ self.title_sample_description() }}

这是第一组数据的样例说明。

{{ s('sample', 2) }}

{{ self.sample_text() }}

{{ self.title_sample_description() }}

{{ s('subtasks') }}

保证 $2\le n\le 100$，$1\le q \le 200$。

保证 $1\le f_i < i$，$0\le r_i,p_i \le 10^9$。

保证相同的 $f_i$ 最多出现两次。

保证 $1\le v \le n$。